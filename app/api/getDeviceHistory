var deviceManager = require("../entities/deviceManager");
var query = {};
if(request.body != null){
	query = request.body;
}else if(request.parameters.body){
	query = request.parameters.body;
} else {
  query = request.parameters;
}

if(typeof query == 'string'){
  	try{
    	query = JSON.parse(query);   
    }catch(e){
      	return "INVALID OR MISSING PARAMETER";
    }
}
var device = deviceManager.getDeviceDefinition("myDevice");
var entries = deviceManager.getDeviceHistoricalEntriesTimescale("myDevice5");
for(var j=0; j<entries.length; j++){
	entries[j].country = device["country"];
    entries[j].city = device["city"];
    entries[j].locationType = device["locationType"];
    entries[j].source = device["source"];
    entries[j].address = device["address"];
    entries[j].physicalEnvironment = device["physicalEnvironment"];
    entries[j].sensor = device["sensor"];
    entries[j].locationSection = device["locationSection"];
    entries[j].key = entries[j].id;
    entries[j].id = device["id"];
    entries[j].creationDate = new Date(entries[j].timestamp.time);
    delete entries[j].timestamp;
}
return entries;